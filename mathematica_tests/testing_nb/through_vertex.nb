(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13230,        384]
NotebookOptionsPosition[     12150,        359]
NotebookOutlinePosition[     12545,        375]
CellTagsIndexPosition[     12502,        372]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "code", " ", "to", " ", "experiment", " ", "with", " ", "how", " ", "we", 
   " ", "should", " ", "write", " ", "a", " ", "through", " ", "vertex", " ", 
   
   RowBox[{"routine", " ", "--"}], " ", "so", " ", "investigating", " ", 
   "properties", " ", "of", " ", "a", " ", "saddle", " ", "vertex"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.911053951118184*^9, 
  3.911053965776561*^9}},ExpressionUUID->"805a73b3-2eb9-4861-ab1a-\
d8cc1d21ef58"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"triangleNormal", " ", "[", "tri_", "]"}], ":=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Normalize", "[", 
    RowBox[{"Cross", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"tri", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", 
       RowBox[{"tri", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"tri", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", 
       RowBox[{"tri", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], "]"}], " ", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"crossMatrix", "[", "vec_", "]"}], ":=", 
  RowBox[{"(", GridBox[{
     {"0", 
      RowBox[{"-", 
       RowBox[{"vec", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], 
      RowBox[{"vec", "[", 
       RowBox[{"[", "2", "]"}], "]"}]},
     {
      RowBox[{"vec", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "0", 
      RowBox[{"-", 
       RowBox[{"vec", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]},
     {
      RowBox[{"-", 
       RowBox[{"vec", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], 
      RowBox[{"vec", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "0"}
    }], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rMatrix", "[", 
   RowBox[{"angle_", ",", "axis_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", "angle", "]"}], "*", 
    RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "+", 
   RowBox[{
    RowBox[{"Sin", "[", "angle", "]"}], "*", 
    RowBox[{"crossMatrix", "[", "axis", "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"Cos", "[", "angle", "]"}]}], ")"}], "*", 
    RowBox[{"TensorProduct", "[", 
     RowBox[{"axis", ",", "axis"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"twoFaceAxis", " ", "[", 
   RowBox[{"face1_", ",", "face2_"}], "]"}], ":=", " ", 
  RowBox[{"Normalize", "[", 
   RowBox[{"Cross", "[", 
    RowBox[{
     RowBox[{"triangleNormal", "[", "face1", "]"}], ",", 
     RowBox[{"triangleNormal", "[", "face2", "]"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"twoFaceAngle", "[", 
   RowBox[{"face1_", ",", "face2_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"ArcCos", "[", 
   RowBox[{"Dot", "[", 
    RowBox[{
     RowBox[{"triangleNormal", "[", "face1", "]"}], ",", 
     RowBox[{"triangleNormal", "[", "face2", "]"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8969512954864397`*^9, 3.8969515280814466`*^9}, {
   3.8969518461676283`*^9, 3.8969518474582653`*^9}, {3.911054743952409*^9, 
   3.9110547455295773`*^9}, {3.911055543930251*^9, 3.9110556015577497`*^9}, {
   3.911055661332902*^9, 3.9110557619861403`*^9}, {3.911057606317265*^9, 
   3.911057702757265*^9}, 3.911057736527179*^9, {3.911057953075583*^9, 
   3.911057955275826*^9}},
 CellLabel->
  "In[369]:=",ExpressionUUID->"d72cb273-ca39-4e89-813f-89d4bf775f6c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"twoFaceAxis", "[", 
  RowBox[{"f1", ",", "f2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"twoFaceAngle", "[", 
  RowBox[{"f1", ",", "f2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "it", " ", "appears", " ", "that", " ", "on", " ", "this", " ", "concave",
      " ", "surface"}], ",", " ", 
    RowBox[{
    "we", " ", "get", " ", "a", " ", "negative", " ", "angle", " ", "instead",
      " ", "of", " ", "a", " ", "positive", " ", "one", 
     RowBox[{"(", "?", ")"}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.911057705772202*^9, 3.911057766625421*^9}, {
  3.911058021576157*^9, 3.911058046433239*^9}},
 CellLabel->
  "In[378]:=",ExpressionUUID->"22f4f74b-3452-4612-858a-a7eccc096368"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.9417419115948374`", ",", 
   RowBox[{"-", "0.33633639699815626`"}], ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.911057708697689*^9, 3.9110577878155537`*^9}, 
   3.911058047057654*^9},
 CellLabel->
  "Out[378]=",ExpressionUUID->"1cdeba68-26e0-425a-9bcc-088be5c0961b"],

Cell[BoxData["2.8821120055237524`"], "Output",
 CellChangeTimes->{{3.911057708697689*^9, 3.9110577878155537`*^9}, 
   3.911058047059145*^9},
 CellLabel->
  "Out[379]=",ExpressionUUID->"ab8f1db4-55fa-4d4a-9944-bfe3189c5883"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.4", ",", ".5", ",", ".25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", ".25"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", ".25"}], ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f3", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", ".25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f4", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", ".25"}], ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{".6", ",", 
       RowBox[{"-", ".5"}], ",", ".125"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f5", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.4", ",", ".5", ",", ".25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{".6", ",", 
       RowBox[{"-", ".5"}], ",", ".125"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"faces", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"f1", ",", "f2", ",", "f3", ",", "f4", ",", "f5"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normals", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"triangleNormal", "[", 
      RowBox[{"faces", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "faces", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"liend", "=", " ", 
   RowBox[{"{", 
    RowBox[{".5", ",", ".5", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"limid", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listart", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", ".2"}], ",", 
     RowBox[{"-", ".2"}], ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "now", " ", "rotate", " ", "liend", " ", "into", " ", "every", " ", "face",
     " ", "aside", " ", "from", " ", "f2", " ", "and", " ", "see", " ", 
    "what", " ", "happens"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.911053710804153*^9, 3.9110539143370237`*^9}, {
  3.911053975036968*^9, 3.9110541079050694`*^9}, {3.911054510365274*^9, 
  3.911054558765579*^9}, {3.911054590875474*^9, 3.9110546385882263`*^9}, {
  3.911054757024509*^9, 3.911054759671783*^9}, {3.9110557840641317`*^9, 
  3.911055804753613*^9}, {3.91105584710289*^9, 3.911055911132947*^9}, {
  3.911057122616476*^9, 3.9110571812230988`*^9}, {3.911057573924954*^9, 
  3.911057598794867*^9}, {3.911057796497957*^9, 3.911057800826133*^9}},
 CellLabel->
  "In[358]:=",ExpressionUUID->"7af02ba3-f665-40cd-bcf8-7a8aedc26dad"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1", " ", "=", " ", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Triangle", "[", "f1", "]"}], ",", "Blue"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2", " ", "=", " ", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Triangle", "[", "f2", "]"}], ",", "Red"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t3", " ", "=", " ", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Triangle", "[", "f3", "]"}], ",", "Green"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t4", " ", "=", " ", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Triangle", "[", "f4", "]"}], ",", "Green"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t5", "=", " ", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Triangle", "[", "f5", "]"}], ",", "Green"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"li", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"listart", ",", " ", "liend"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"liGraph", " ", "=", " ", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"Thickness", "->", ".01"}], ",", 
      RowBox[{"Line", "[", "li", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
  "t1", ",", "t2", ",", "t3", ",", "t4", ",", "t5", ",", "liGraph", ",", 
   RowBox[{"Axes", "->", "True"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9110558793251753`*^9, 3.911055879617197*^9}, {
  3.911057074275311*^9, 3.911057111848424*^9}, {3.911057157102043*^9, 
  3.911057173077859*^9}},
 CellLabel->
  "In[322]:=",ExpressionUUID->"f61a9059-212c-43d3-90e0-3533121e6200"],

Cell[BoxData[
 Graphics3DBox[{{
    TagBox[Polygon3DBox[{{0, 0, 0}, {1.4, 0.5, 0.25}, {0, 1, 0.25}}],
     "Triangle"], 
    {RGBColor[0, 0, 1]}}, {
    TagBox[Polygon3DBox[{{-0.25, -1, 0}, {-1, 0, 0}, {0, 0, 0}}],
     "Triangle"], 
    {RGBColor[1, 0, 0]}}, {
    TagBox[Polygon3DBox[{{-1, 0, 0}, {0, 1, 0.25}, {0, 0, 0}}],
     "Triangle"], 
    {RGBColor[0, 1, 0]}}, {
    TagBox[Polygon3DBox[{{-0.25, -1, 0}, {0.6, -0.5, 0.125}, {0, 0, 0}}],
     "Triangle"], 
    {RGBColor[0, 1, 0]}}, {
    TagBox[Polygon3DBox[{{1.4, 0.5, 0.25}, {0.6, -0.5, 0.125}, {0, 0, 0}}],
     "Triangle"], 
    {RGBColor[0, 1, 0]}}, 
   {RGBColor[1, 0, 0], Thickness[0.01], 
    Line3DBox[{{0.5, 0.5, 0}, {-0.2, -0.2, 0}}]}},
  Axes->True,
  ImageSize->{522.659759664587, 116.8149380715696},
  ImageSizeRaw->Automatic,
  ViewPoint->{1.840571291843214, -2.8000208767957466`, 0.47136016924489976`},
  ViewVertical->{0.029964598055375973`, -0.05649346114509895, 
   0.9979532111833835}]], "Output",
 CellChangeTimes->{
  3.911055879914707*^9, {3.9110570938191442`*^9, 3.91105712689979*^9}, {
   3.911057173411723*^9, 3.911057182819592*^9}},
 CellLabel->
  "Out[329]=",ExpressionUUID->"f66ad91c-3a26-4575-84e9-903e8f04bb9f"]
}, Open  ]]
},
WindowSize->{606., 659.25},
WindowMargins->{{Automatic, 0}, {34.5, Automatic}},
FrontEndVersion->"13.1 for Linux x86 (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"50e50262-b0f4-4cf3-b12e-551036f04896"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 491, 11, 73, "Input",ExpressionUUID->"805a73b3-2eb9-4861-ab1a-d8cc1d21ef58"],
Cell[1052, 33, 2914, 81, 279, "Input",ExpressionUUID->"d72cb273-ca39-4e89-813f-89d4bf775f6c"],
Cell[CellGroupData[{
Cell[3991, 118, 763, 18, 93, "Input",ExpressionUUID->"22f4f74b-3452-4612-858a-a7eccc096368"],
Cell[4757, 138, 318, 7, 48, "Output",ExpressionUUID->"1cdeba68-26e0-425a-9bcc-088be5c0961b"],
Cell[5078, 147, 223, 4, 71, "Output",ExpressionUUID->"ab8f1db4-55fa-4d4a-9944-bfe3189c5883"]
}, Open  ]],
Cell[5316, 154, 3687, 110, 265, "Input",ExpressionUUID->"7af02ba3-f665-40cd-bcf8-7a8aedc26dad"],
Cell[CellGroupData[{
Cell[9028, 268, 1901, 57, 181, "Input",ExpressionUUID->"f61a9059-212c-43d3-90e0-3533121e6200"],
Cell[10932, 327, 1202, 29, 148, "Output",ExpressionUUID->"f66ad91c-3a26-4575-84e9-903e8f04bb9f"]
}, Open  ]]
}
]
*)

